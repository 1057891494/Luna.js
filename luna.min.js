/*! 
====================================
    个人内部使用的小型js工具库
    心叶
    V0.0.1-alpha
    最后修改于：2018-02-03
====================================
*/

!function(e,t,r){"use strict";if(!e||!e.document)throw new Error("Luna requires a window with a document!");!function(e,t){var r=function(e,t){return new r.prototype.init(e,t)};r.prototype.init=function(e,i,o){var s;if("string"==typeof e&&(e=(e+"").trim()),this.length=0,o=o||n,i=i?r(i)[0]:document,!e)return this;if(this.selector=e,"body"==e)return this.context=document,this[0]=document.body,this.isTouch=!0,this.length=1,this;if("string"==typeof e){if(e=(e+"").trim().replace(/[\n\f\r]/g,""),/^</.test(e)){if(!i)throw new Error("Parameter error!");var l=document.createElement("div");return l.innerHTML=e,this[0]=l.childNodes[0],this.isTouch=!0,this.length=1,this.context=t,this}if(!r.sizzle)throw new Error("Sizzle is necessary for Luna!");var c=r.sizzle(e,i);for(s=0;s<c.length;s++)this[s]=c[s];return this.length=s,this.isTouch=!0,this.context=i,this}if(1===e.nodeType||11===e.nodeType||9===e.nodeType)return this.context=i,this[0]=e,this.isTouch=!0,this.length=1,this;if("function"==typeof e)return r.__isLoad__?e():document.addEventListener?document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e(),r.__isLoad__=!0}):document.attachEvent&&document.attachEvent("onreadystatechange",function t(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e(),r.__isLoad__=!0)}),this;if(e.isTouch){for(this.isTouch=!0,s=0;s<e.length;s++)this[s]=e[s];return this.context=e.context||i,this.length=e.length,this.selector=e.selector,this}return this};var n=r(document);r.prototype.extend=r.extend=function(){var e=arguments[0]||{},t=arguments[1]||{},r=arguments.length;for(var n in 1===r&&(t=e,e=this),"object"!=typeof e&&"function"!=typeof e&&(e={}),t)try{e[n]=t[n]}catch(e){throw new Error("Illegal property value！")}return e},r.prototype.init.prototype=r.prototype,r.__isLoad__=!1,r.clock={timers:[],interval:13,speeds:400,timerId:null},r._sizzle_={},e.Luna=e.$=r}(e)}(window),function(e,t,r){"use strict";t.prototype.extend({bind:function(r,n,i){var o=t(this);return e.attachEvent?o[0].attachEvent("on"+r,n):(i=i||!1,o[0].addEventListener(r,n,i)),o},unbind:function(r,n,i){var o=t(this);return e.detachEvent?o[0].detachEvent("on"+r,n):(i=i||!1,o[0].removeEventListener(r,n,i)),o}})}(window,window.Luna),function(e,t,r){"use strict";t.prototype.extend({html:function(e){var r=t(this);if(""==e||e){for(var n=0;n<r.length;n++)r[n].innerHTML=e;return r}return r[0].innerHTML},text:function(e){var r=t(this);if(e){for(var n=0;n<r.length;n++)r[0].innerText=e;return r}return r[0].innerText},val:function(e){var r=t(this);if(e){for(var n=0;n<r.length;n++)r[0].value=e;return r}return r[0].value},attr:function(e,r){var n=t(this);if(r){for(var i=0;i<n.length;i++)n[0].setAttribute(e,r);return n}return n[0].getAttribute(e)},hasClass:function(e){var r=t(this[0]);return!!("string"==typeof e&&e&&(" "+r.class()+" ").search(" "+e+" ")>=0)},addClass:function(e){var r,n,i=t(this);if("string"==typeof e&&e){var o=0;for(r=i[o++];r;){n=r.getAttribute("class")||"";var s=t.uniqueClass(n,e);r.setAttribute("class",s),r=i[o++]}}return i},removeClass:function(e){var r,n,i=t(this);if("string"==typeof e&&e){var o=0;for(r=i[o++];r;){n=r.getAttribute("class")||"";var s=t.operateClass(n,e,!0);r.setAttribute("class",s),r=i[o++]}}return i},toggleClass:function(e){var r,n,i=t(this);if("string"==typeof e&&e){var o=0;for(r=i[o++];r;){n=r.getAttribute("class")||"";var s=t.operateClass(n,e);r.setAttribute("class",s),r=i[o++]}}return i},class:function(e){var r,n=t(this);if("string"!=typeof e||!e)return n[0].getAttribute("class")||"";var i=0;for(r=n[i++];r;)r.setAttribute("class",t.uniqueClass(e)),r=n[i++];return n},css:function(e,r){var n,i=t(this);if("string"==typeof e&&1===arguments.length)return i[0].style[e];if("string"==typeof e&&"string"==typeof r)for(n=0;n<i.length;n++)i[n].style[e]=r;else{if("object"!=typeof e)throw new Error("Not acceptable type!");for(var o in e)for(n=0;n<i.length;n++)i[n].style[o]=e[o]}return i},append:function(e){var r,n=t(this);if(1===e.nodeType||11===e.nodeType||9===e.nodeType)for(r=0;r<n.length;r++)n[r].appendChild(e);else if(e.isTouch)for(r=0;r<n.length;r++)n[r].appendChild(e[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");for(r=0;r<n.length;r++)n[r].appendChild(t(e)[0])}return n},prepend:function(e){var r,n=t(this);if(1===e.nodeType||11===e.nodeType||9===e.nodeType)for(r=0;r<n.length;r++)n[r].insertBefore(e,n[0].childNodes[0]);else if(e.isTouch)for(r=0;r<n.length;r++)n[r].insertBefore(e[0],n[0].childNodes[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");for(r=0;r<n.length;r++)n[r].insertBefore(t(e)[0],n[0].childNodes[0])}return n},after:function(e){var r,n,i=t(this);for(r=0;r<i.length;r++)if(n=i[r].parentNode||t("body")[0],1===e.nodeType||11===e.nodeType||9===e.nodeType)n.insertBefore(e,i[0].nextSibling);else if(e.isTouch)n.insertBefore(e[0],i[0].nextSibling);else{if("string"!=typeof e)throw new Error("Not acceptable type!");n.insertBefore(t(e)[0],i[0].nextSibling)}return i},before:function(e){var r,n,i=t(this);for(n=0;n<i.length;n++)if(r=i[0].parentNode||t("body")[0],1===e.nodeType||11===e.nodeType||9===e.nodeType)r.insertBefore(e,i[0]);else if(e.isTouch)r.insertBefore(e[0],i[0]);else{if("string"!=typeof e)throw new Error("Not acceptable type!");r.insertBefore(t(e)[0],i[0])}return i},remove:function(){var e,r=t(this);for(e=0;e<r.length;e++){(r[e].parentNode||t("body")[0]).removeChild(r[0])}return r},empty:function(){var e,r=t(this);for(e=0;e<r.length;e++)$(r[e]).html("");return r}})}(window,window.Luna),function(e,t,r){"use strict";t.extend({outerHTML:function(e){return e.outerHTML||(t=e,(n=document.createElement("div")).appendChild(t),r=n.innerHTML,n=null,r);var t,r,n},uniqueClass:function(){for(var e="",t=0;t<arguments.length;t++){if("string"!=typeof arguments[t])throw new Error("Only string is valid,not project!");e+=arguments[t]+" "}var r=(e=e.trim()).split(/ +/),n={};for(var i in r.forEach(function(e){n[e]=!0},this),e="",n)n[i]&&(e+=i+" ");return e.trim()},operateClass:function(e,t,r){if("string"!=typeof e||"string"!=typeof t)throw new Error("Only string is valid,not project!");e=e.trim(),t=t.trim();var n=e.split(/ +/),i=t.split(/ +/),o={};n.forEach(function(e){o[e]=!0},this),i.forEach(function(e){o[e]=!r&&!o[e]},this);var s="";for(var l in o)o[l]&&(s+=l+" ");return s.trim()}})}(window,window.Luna),function(e,t,r){"use strict";t.extend({animation:function(e,r,n){t.clock.timer(function(t){e(t)},r,n)}}),t.extend(t.clock,{timer:function(e,r,n){if(!e)throw new Error("tick is required!");r=r||t.clock.speeds,t.clock.timers.push({createTime:new Date,tick:e,duration:r,callback:n}),t.clock.start()},start:function(){t.clock.timerId||(t.clock.timerId=e.setInterval(t.clock.tick,t.clock.interval))},tick:function(){var e,r,n,i,o,s,l,c=t.clock.timers;for(t.clock.timers=[],t.clock.timers.length=0,r=0;r<c.length;r++)e=(o=c[r]).createTime,n=o.tick,s=o.duration,i=o.callback,!1,(l=(+new Date-e)/s)>=1&&!0,n(100*(l=l>1?1:l)),l<1?t.clock.timers.push(o):i&&i();t.clock.timers.length<=0&&t.clock.stop()},stop:function(){t.clock.timerId&&(e.clearInterval(t.clock.timerId),t.clock.timerId=null)}})}(window,window.Luna),function(e,t,r){"use strict";t.extend(t._sizzle_,{notLayer:function(e){return!/[> ~+]/.test(e)},notComplex:function(e){return!t._sizzle_.notLayer(e)||(!/[#.[]/.test(e)||!!/^[#.[]/.test(e)&&(e=e.replace(/^[#.[]/,""),!/[#.[]/.test(e)))},isSingle:function(e){return!(!t._sizzle_.notLayer(e)||!t._sizzle_.notComplex(e))},isID:function(e){return!!/^#/.test(e)},isClass:function(e){return!!/^\./.test(e)},isElemment:function(e){return!/^[#.[]/.test(e)},isAttr:function(e){return!!/^\[([^=]+)=(["'])([^=]+)\2\]$/.test(e)},isValidComplex:function(e){return""==(e=(e=(e=(e=e.replace(/^[^#.[]+/,"")).replace(/\[([^=]+)=(["'])([^=]+)\2\]/g,"")).replace(/#[^#.[]+/g,"")).replace(/\.[^#.[]+/g,""))},toComplexSelectorObject:function(e){var t,r={},n=e.match(/^[^#.[]+/);if(n&&n.length>0&&(r._elem_=n[0]),(n=e.match(/\[([^=]+)=(["'])([^=]+)\2\]/g))&&n.length>0)for(r._attr_=[],t=0;t<n.length;t++)r._attr_.push(n[t]);if((n=e.match(/#[^#.[]+/g))&&n.length>0&&(r._id_=n[0].replace(/^#/,"")),(n=e.match(/\.[^#.[]+/g))&&n.length>0)for(r._class_=[],t=0;t<n.length;t++)r._class_.push(n[t].replace(/^\./,""));return r},checkedElems:function(e,t){var r,n,i,o,s=[];for(r=0;r<e.length;r++){if(o=!0,t._elem_&&o&&e[r].tagName!=(t._elem_+"").toUpperCase()&&(o=!1),t._class_&&t._class_.length>0&&o)for(i=" "+(i=e[r].getAttribute("class")||"")+" ",n=0;n<t._class_.length&&o;n++)i.search(" "+t._class_[n]+" ")<0&&(o=!1);if(t._attr_&&t._attr_.length>0&&o)for(n=0;n<t._attr_.length&&o;n++){var l=/^\[([^=]+)=(["'])([^=]+)\2\]$/.exec(t._attr_[n]);e[r].getAttribute(l[1])!=l[3]&&(o=!1)}o&&s.push(e[r])}return s}}),t.extend({sizzle:function(e,r){var n,i,o=[];if("*"==(e=e.trim()))for(i=r.getElementsByTagName("*"),n=0;n<i.length;n++)o.push(i[n]);else if(t._sizzle_.isSingle(e))if(t._sizzle_.isID(e))o.push(document.getElementById(e.replace(/^#/,"")));else if(t._sizzle_.isClass(e))if(r.getElementsByClassName)for(i=r.getElementsByClassName(e.replace(/^./,"")),n=0;n<i.length;n++)o.push(i[n]);else for(i=r.getElementsByTagName("*"),n=0;n<i.length;n++)t(i[n]).hasClass(e.replace(/^./,""))&&o.push(i[n]);else if(t._sizzle_.isElemment(e))for(i=r.getElementsByTagName(e),n=0;n<i.length;n++)o.push(i[n]);else{if(!t._sizzle_.isAttr(e))throw new Error("invalid selector1:"+e);if(r.querySelectorAll){i=r.getElementsByTagName("*");var s=/^\[([^=]+)=(["'])([^=]+)\2\]$/.exec(e);for(n=0;n<i.length;n++)s[3]==t(i[n]).attr(s[1])&&o.push(i[n])}else for(i=r.querySelectorAll(e),n=0;n<i.length;n++)o.push(i[n])}else{if(!t._sizzle_.notLayer(e))throw new Error("undesigned selector:"+e);if(!t._sizzle_.isValidComplex(e))throw new Error("invalid selector2:"+e);var l=t._sizzle_.toComplexSelectorObject(e),c=[];if(l._id_)return c=[document.getElementById(l._id_)],t._sizzle_.checkedElems(c,l);if(l._elem_)return c=r.getElementsByTagName(l._elem_),t._sizzle_.checkedElems(c,l);if(!(l._class_&&l._class_.length>0))return c=r.getElementsByTagName("*"),t._sizzle_.checkedElems(c,l);if(r.getElementsByClassName)return c=r.getElementsByClassName(l._class_[0]),t._sizzle_.checkedElems(c,l)}return o}})}(window,window.Luna);